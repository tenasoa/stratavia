<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Découvrez la meilleure stratégie pour maximiser vos gains avec Aviator. Calculez vos temps de jeu et suivez vos performances en temps réel." />
    <meta name="keywords" content="Aviator, stratégie, gains, calcul, performance, temps réel" />
    <meta name="author" content="TenaSoa" />
    <title>Stratégie Aviator by TenaSoa</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

      :root {
        --primary-color: #6366f1;
        --primary-hover: #4f46e5;
        --secondary-color: #1e293b;
        --background-dark: #0f172a;
        --background-light: #f8fafc;
        --card-bg-dark: #1e293b;
        --card-bg-light: #ffffff;
        --text-light: #f8fafc;
        --text-dark: #0f172a;
        --text-secondary: #94a3b8;
        --danger-color: #ef4444;
        --success-color: #10b981;
        --warning-color: #f59e0b;
        --font-family: 'Poppins', sans-serif;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: var(--font-family);
        background-color: var(--background-dark);
        color: var(--text-light);
        line-height: 1.6;
        min-height: 100vh;
        background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        transition: background-color 0.3s, color 0.3s;
      }

      body.light-theme {
        background-color: var(--background-light);
        color: var(--text-dark);
        background: none;
      }

      .container {
        max-width: 1000px;
        margin: 0 auto;
        padding: 2rem;
      }

      .header {
        text-align: center;
        margin-bottom: 3rem;
        animation: fadeInDown 1s ease;
      }

      .header h1 {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--text-light);
        margin-bottom: 1rem;
        background: linear-gradient(to right, #6366f1, #8b5cf6);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .header p {
        font-size: 1.1rem;
        color: var(--text-secondary);
        max-width: 600px;
        margin: 0 auto;
      }

      .card {
        background: var(--card-bg-dark);
        border-radius: 1rem;
        padding: 2rem;
        margin-bottom: 2rem;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        animation: fadeInUp 1s ease;
        border: 1px solid rgba(255, 255, 255, 0.1);
        transition: background-color 0.3s;
      }

      body.light-theme .card {
        background: var(--card-bg-light);
        border: 1px solid rgba(0, 0, 0, 0.1);
      }

      .card h2,
      .card h3 {
        color: var(--text-light);
        margin-bottom: 1.5rem;
        font-weight: 600;
        font-size: 1.5rem;
      }

      body.light-theme .card h2,
      body.light-theme .card h3 {
        color: var(--text-dark);
      }

      table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0 0.75rem;
      }

      th {
        background-color: rgba(255, 255, 255, 0.05);
        color: var(--text-secondary);
        font-weight: 500;
        padding: 1rem;
        text-align: left;
        border-radius: 0.5rem;
      }

      td {
        padding: 1rem;
        background-color: rgba(255, 255, 255, 0.02);
        border-radius: 0.5rem;
      }

      input {
        background-color: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        color: var(--text-light);
        padding: 0.75rem 1rem;
        border-radius: 0.5rem;
        width: 100%;
        font-family: var(--font-family);
        font-size: 1rem;
        transition: all 0.3s ease;
      }

      body.light-theme input {
        background-color: rgba(0, 0, 0, 0.05);
        border: 1px solid rgba(0, 0, 0, 0.1);
        color: var(--text-dark);
      }

      input:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
      }

      button {
        background-color: var(--primary-color);
        color: white;
        border: none;
        padding: 0.75rem 1.5rem;
        border-radius: 0.5rem;
        cursor: pointer;
        font-family: var(--font-family);
        font-weight: 500;
        font-size: 1rem;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
      }

      button:hover {
        background-color: var(--primary-hover);
        transform: translateY(-2px);
      }

      .delete-btn {
        background-color: transparent;
        border: 1px solid var(--danger-color);
        color: var(--danger-color);
      }

      .delete-btn:hover {
        background-color: var(--danger-color);
        color: white;
      }

      .countdown {
        background-color: rgba(255, 255, 255, 0.05);
        padding: 0.5rem 1rem;
        border-radius: 0.5rem;
        font-family: monospace;
        font-size: 0.9rem;
        color: var(--text-secondary);
      }

      .hint {
        color: var(--text-secondary);
        font-size: 0.8rem;
        margin-top: 0.5rem;
      }

      .toast {
        position: fixed;
        bottom: 2rem;
        right: 2rem;
        padding: 1rem 1.5rem;
        border-radius: 0.5rem;
        color: white;
        font-weight: 500;
        visibility: hidden;
        opacity: 0;
        transform: translateY(1rem);
        transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        z-index: 1000;
      }

      .toast.show {
        visibility: visible;
        opacity: 1;
        transform: translateY(0);
      }

      .toast.success { background-color: var(--success-color); }
      .toast.warning { background-color: var(--warning-color); }
      .toast.error { background-color: var(--danger-color); }

      .action-cell {
        display: flex;
        gap: 1rem;
        align-items: center;
      }

      @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
      }

      @keyframes fadeInDown {
        from { opacity: 0; transform: translateY(-20px); }
        to { opacity: 1; transform: translateY(0); }
      }

      @media (max-width: 768px) {
        .container { padding: 1rem; }
        .header h1 { font-size: 2rem; }
        .card { padding: 1.5rem; }
        .action-cell { flex-direction: column; }
        td { padding: 0.75rem; }
      }

      tr {
        transition: all 0.3s ease;
      }

      tr.fade-out {
        opacity: 0;
        transform: translateX(100%);
      }

      tr:hover td {
        background-color: rgba(255, 255, 255, 0.05);
      }

      .chart-container {
        margin-top: 2rem;
        padding: 1rem;
        background: var(--card-bg-dark);
        border-radius: 1rem;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      }

      body.light-theme .chart-container {
        background: var(--card-bg-light);
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>Stratégie Aviator by TenaSoa</h1>
        <p>Découvrez la meilleure stratégie pour maximiser vos gains avec Aviator. Calculez vos temps de jeu et suivez vos performances en temps réel.</p>
        <button onclick="toggleTheme()">Basculer vers le thème clair</button>
      </div>

      <div class="card">
        <h2>Faites vos calculs</h2>
        <table>
          <tr>
            <th>Période</th>
            <th>Temps</th>
          </tr>
          <tr>
            <td>1<sup>ère</sup> Heure</td>
            <td>
              <input type="text" id="time1" placeholder="HH:MM:SS" value="" />
              <div class="hint">Format: HH:MM:SS (ex: 08:19:25)</div>
            </td>
          </tr>
          <tr>
            <td>2<sup>ème</sup> Heure</td>
            <td>
              <input type="text" id="time2" placeholder="HH:MM:SS" value="" />
              <div class="hint">Format: HH:MM:SS (ex: 08:20:59)</div>
            </td>
          </tr>
        </table>
        <button onclick="calculate()"><i class="fas fa-calculator"></i> Calculer les résultats</button>
      </div>

      <div class="card">
        <h3>Historique des calculs</h3>
        <button onclick="sortHistory()"><i class="fas fa-sort"></i> Trier par Résultat</button>
        <table id="historyTable">
          <thead>
            <tr>
              <th>1ère Heure</th>
              <th>2ème Heure</th>
              <th>Résultat</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody id="historyBody"></tbody>
        </table>
      </div>

      <div class="card chart-container">
        <h3>Tendances des Résultats</h3>
        <canvas id="resultsChart"></canvas>
      </div>
    </div>

    <div id="toast" class="toast"></div>

    <script>
      // Validation du format de l'heure
      function validateTimeFormat(timeStr) {
        const pattern = /^([0-1]?[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]$/;
        if (!pattern.test(timeStr)) {
          showToast("Format d'heure invalide. Utilisez HH:MM:SS (ex: 08:19:25)", "error");
          return false;
        }
        return true;
      }

      // Conversion de l'heure en minutes
      function timeToMinutes(timeStr) {
        const [hours, minutes, seconds] = timeStr.split(":").map(Number);
        return hours * 60 + minutes + seconds / 60;
      }

      // Conversion des minutes en heure
      function minutesToTime(minutes) {
        minutes = (minutes + 1440) % 1440; // Ajuster pour rester dans 24h
        const hours = Math.floor(minutes / 60);
        const mins = Math.floor(minutes % 60);
        const secs = Math.round((minutes % 1) * 60);
        return `${String(hours).padStart(2, "0")}:${String(mins).padStart(2, "0")}:${String(secs).padStart(2, "0")}`;
      }

      // Affichage des notifications toast
      function showToast(message, type = "success") {
        const toast = document.getElementById("toast");
        toast.textContent = message;
        toast.className = "toast " + type;
        toast.classList.add("show");
        setTimeout(() => toast.classList.remove("show"), 3000);
      }

      // Suppression d'une ligne de l'historique
      function deleteRow(button) {
        const row = button.parentNode.parentNode;
        row.classList.add("fade-out");
        setTimeout(() => {
          row.remove();
          updateChart();
        }, 300);
        showToast("Entrée supprimée avec succès");
      }

      // Démarrage du compte à rebours
      function startCountdown(row, targetTime) {
        const countdownElement = row.querySelector(".countdown");

        function updateCountdown() {
          const now = new Date();
          const target = new Date();
          const [hours, minutes, seconds] = targetTime.split(":").map(Number);
          target.setHours(hours, minutes, seconds);

          if (target < now) target.setDate(target.getDate() + 1);

          const diff = target - now;
          if (diff <= 0) {
            row.classList.add("fade-out");
            setTimeout(() => row.remove(), 300);
            return;
          }

          const totalSeconds = Math.floor(diff / 1000);
          const h = Math.floor(totalSeconds / 3600);
          const m = Math.floor((totalSeconds % 3600) / 60);
          const s = totalSeconds % 60;
          countdownElement.textContent = `${String(h).padStart(2, "0")}:${String(m).padStart(2, "0")}:${String(s).padStart(2, "0")}`;

          if (diff <= 60000 && diff > 59000) {
            showToast("Une échéance approche dans 1 minute!", "warning");
            if (Notification.permission === "granted") {
              new Notification("Moment optimal pour jouer dans 1 minute !");
            }
          }
        }

        updateCountdown();
        return setInterval(updateCountdown, 1000);
      }

      // Ajout à l'historique
      function addToHistory(time1, time2, result) {
        const historyBody = document.getElementById("historyBody");
        const newRow = document.createElement("tr");
        newRow.innerHTML = `
          <td>${time1}</td>
          <td>${time2}</td>
          <td>${result}</td>
          <td class="action-cell">
            <button class="delete-btn" onclick="deleteRow(this)"><i class="fas fa-trash"></i> Supprimer</button>
            <span class="countdown">00:00:00</span>
          </td>
        `;
        historyBody.appendChild(newRow);
        startCountdown(newRow, result);
        updateChart();
      }

      // Calcul des résultats
      function calculate() {
        const time1 = document.getElementById("time1").value;
        const time2 = document.getElementById("time2").value;

        if (!validateTimeFormat(time1) || !validateTimeFormat(time2)) return;

        const D4 = timeToMinutes(time2) - timeToMinutes(time1);
        const E4 = timeToMinutes(time2) + timeToMinutes(time1);
        const G2 = timeToMinutes(time1.split(":")[0] + ":00:00");
        let F4 = E4 - D4 * 2 - G2;

        F4 = (F4 + 1440) % 1440; // Ajuster pour rester dans 24h
        const resultTime = minutesToTime(F4);

        addToHistory(time1, time2, resultTime);
        showToast("Résultat calculé avec succès");

        document.getElementById("time1").value = time2;
        document.getElementById("time2").value = "";
      }

      // Tri de l'historique
      function sortHistory() {
        const historyBody = document.getElementById("historyBody");
        const rows = Array.from(historyBody.querySelectorAll("tr"));
        rows.sort((a, b) => timeToMinutes(a.cells[2].textContent) - timeToMinutes(b.cells[2].textContent));
        rows.forEach(row => historyBody.appendChild(row));
      }

      // Changement de thème
      function toggleTheme() {
        document.body.classList.toggle("light-theme");
        const button = document.querySelector("button[onclick='toggleTheme()']");
        button.textContent = document.body.classList.contains("light-theme") ? "Basculer vers le thème sombre" : "Basculer vers le thème clair";
      }

      // Mise à jour du graphique
      function updateChart() {
        const historyBody = document.getElementById("historyBody");
        const rows = historyBody.querySelectorAll("tr");
        const labels = [];
        const data = [];

        rows.forEach((row, index) => {
          const result = row.cells[2].textContent;
          labels.push(`Résultat ${index + 1}`);
          data.push(timeToMinutes(result));
        });

        const ctx = document.getElementById("resultsChart").getContext("2d");
        if (window.resultsChart) window.resultsChart.destroy();

        window.resultsChart = new Chart(ctx, {
          type: "line",
          data: {
            labels: labels,
            datasets: [{
              label: "Temps de Résultat (en minutes)",
              data: data,
              borderColor: "#6366f1",
              backgroundColor: "rgba(99, 102, 241, 0.2)",
              fill: true,
            }]
          },
          options: {
            responsive: true,
            scales: { y: { beginAtZero: true } }
          }
        });
      }

      // Demande de permission pour les notifications
      if (Notification.permission !== "granted") Notification.requestPermission();
    </script>
  </body>
</html>
