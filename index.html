<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Découvrez la meilleure stratégie pour maximiser vos gains avec Aviator. Calculez vos temps de jeu et suivez vos performances en temps réel.">
    <meta name="keywords" content="Aviator, stratégie, gains, calcul, performance, temps réel">
    <meta name="author" content="TenaSoa">
    <title>Strategie Aviator by TenaSoa</title>
    <style>
      :root {
        --primary-color: #2196f3;
        --secondary-color: #1976d2;
        --background-dark: #1e1e1e;
        --text-light: #ffffff;
        --text-secondary: #b0b0b0;
        --danger-color: #ff4444;
        --success-color: #00c853;
        --font-family: "Roboto", sans-serif;
      }

      body {
        font-family: var(--font-family);
        background-color: var(--background-dark);
        color: var(--text-light);
        padding: 20px;
        margin: 0;
        min-height: 100vh;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      .header {
        text-align: center;
        margin-bottom: 40px;
      }

      .header h1 {
        font-size: 2.5em;
        color: var(--primary-color);
        margin-bottom: 10px;
      }

      .header p {
        font-size: 1.2em;
        color: var(--text-secondary);
        margin-bottom: 20px;
      }

      .card {
        background: #2d2d2d;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;
      }

      .card:hover {
        transform: translateY(-5px);
      }

      h2,
      h3 {
        color: var(--primary-color);
        margin-bottom: 20px;
        font-size: 1.5em;
      }

      table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0 8px;
        margin-top: 20px;
      }

      th {
        background-color: #333;
        color: var(--text-light);
        padding: 12px;
        text-align: left;
        font-weight: 500;
      }

      td {
        background-color: #2d2d2d;
        padding: 12px;
        color: var(--text-light);
      }

      tr {
        transition: all 0.3s ease;
      }

      tr.fade-out {
        opacity: 0;
        transform: translateX(100%);
      }

      input {
        background-color: #333;
        border: 1px solid #444;
        color: var(--text-light);
        padding: 10px 12px;
        border-radius: 4px;
        width: 100%;
        font-family: monospace;
        font-size: 1em;
      }

      input:focus {
        outline: none;
        border-color: var(--primary-color);
      }

      button {
        background-color: var(--primary-color);
        color: white;
        border: none;
        padding: 12px 20px;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.3s ease;
        width: 100%;
        margin-top: 10px;
        font-size: 1em;
      }

      button:hover {
        background-color: var(--secondary-color);
      }

      .delete-btn {
        background-color: var(--danger-color);
        padding: 8px 12px;
        margin-right: 10px;
        font-size: 0.9em;
      }

      .progress-container {
        display: inline-block;
        width: 100%;
        height: 6px;
        background-color: #444;
        border-radius: 3px;
        margin-left: 10px;
        vertical-align: middle;
      }

      .progress-bar {
        height: 100%;
        background-color: var(--primary-color);
        border-radius: 3px;
        transition: width 1s linear;
      }

      .countdown {
        margin-left: 10px;
        color: var(--text-secondary);
        font-size: 0.9em;
      }

      .toast {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 15px 25px;
        border-radius: 4px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        visibility: hidden;
        opacity: 0;
        transition: all 0.3s ease;
        font-size: 0.9em;
      }

      .toast.show {
        visibility: visible;
        opacity: 1;
      }

      .toast.success {
        background-color: var(--success-color);
        color: white;
      }

      .toast.warning {
        background-color: #ffa000;
        color: white;
      }

      .toast.error {
        background-color: var(--danger-color);
        color: white;
      }

      .hint {
        color: var(--text-secondary);
        font-size: 0.8em;
        margin-top: 4px;
      }

      .action-cell {
        display: flex;
        align-items: center;
        flex-direction: column;
      }

      .illustration {
        text-align: center;
        margin-bottom: 40px;
      }

      .illustration img {
        max-width: 100%;
        height: auto;
        border-radius: 8px;
      }

      @media (min-width: 600px) {
        .action-cell {
          flex-direction: row;
        }

        button {
          width: auto;
          margin-top: 0;
        }

        input {
          width: auto;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>Strategie Aviator by TenaSoa</h1>
        <p>Découvrez la meilleure stratégie pour maximiser vos gains avec Aviator. Calculez vos temps de jeu et suivez vos performances en temps réel.</p>
      </div>
      <div class="card">
        <h2>Faite vous plaisir</h2>
        <table>
          <tr>
            <th>Période</th>
            <th>Temps</th>
          </tr>
          <tr>
            <td>1<sup>er</sup> Heure</td>
            <td>
              <input
                type="number"
                id="time1"
                placeholder="HH:MM:SS"
                value=""
              />
              <div class="hint">Format: HH:MM:SS (ex: 08:19:25)</div>
            </td>
          </tr>
          <tr>
            <td>2<sup>ème</sup> Heure</td>
            <td>
              <input
                type="number"
                id="time2"
                placeholder="HH:MM:SS"
                value=""
              />
              <div class="hint">Format: HH:MM:SS (ex: 08:20:59)</div>
            </td>
          </tr>
        </table>

        <button onclick="calculate()">Calculer</button>
      </div>

      <div class="card">
        <h3>Historique des calculs</h3>
        <table id="historyTable">
          <thead>
            <tr>
              <th>1ère Heure</th>
              <th>2ème Heure</th>
              <th>Résultat</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody id="historyBody"></tbody>
        </table>
      </div>
    </div>

    <div id="toast" class="toast"></div>

    <script>
      function validateTimeFormat(timeStr) {
        const pattern = /^([0-1]?[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]$/;
        return pattern.test(timeStr);
      }

      function timeToMinutes(timeStr) {
        const [hours, minutes, seconds] = timeStr.split(":").map(Number);
        return hours * 60 + minutes + seconds / 60;
      }

      function minutesToTime(minutes) {
        const hours = Math.floor(minutes / 60);
        const mins = Math.floor(minutes % 60);
        const secs = Math.round((minutes % 1) * 60);
        return `${String(hours).padStart(2, "0")}:${String(mins).padStart(
          2,
          "0"
        )}:${String(secs).padStart(2, "0")}`;
      }

      function showToast(message, type = "success") {
        const toast = document.getElementById("toast");
        toast.textContent = message;
        toast.className = "toast " + type;
        toast.classList.add("show");

        setTimeout(() => {
          toast.classList.remove("show");
        }, 3000);
      }

      function deleteRow(button) {
        const row = button.parentNode.parentNode;
        row.classList.add("fade-out");
        setTimeout(() => {
          row.parentNode.removeChild(row);
        }, 300);
        showToast("Entrée supprimée avec succès");
      }

      function updateProgressBar(progressBar, remainingTime, totalTime) {
        const percentage = (remainingTime / totalTime) * 100;
        progressBar.style.width = `${percentage}%`;
      }

      function startCountdown(row, targetTime) {
        const countdownElement = row.querySelector(".countdown");
        const progressBar = row.querySelector(".progress-bar");

        function updateCountdown() {
          const now = new Date();
          const target = new Date();
          const [hours, minutes, seconds] = targetTime.split(":").map(Number);
          target.setHours(hours, minutes, seconds);

          if (target < now) {
            target.setDate(target.getDate() + 1);
          }

          const diff = target - now;
          if (diff <= 0) {
            row.classList.add("fade-out");
            setTimeout(() => row.remove(), 300);
            return;
          }

          const totalSeconds = Math.floor(diff / 1000);
          const h = Math.floor(totalSeconds / 3600);
          const m = Math.floor((totalSeconds % 3600) / 60);
          const s = totalSeconds % 60;

          countdownElement.textContent = `${String(h).padStart(
            2,
            "0"
          )}:${String(m).padStart(2, "0")}:${String(s).padStart(2, "0")}`;

          // Check if result is within 1 minute
          if (diff <= 60000 && diff > 59000) {
            showToast("Une échéance approche dans 1 minute!", "warning");
          }

          // Update progress bar
          const totalTime = 24 * 60 * 60 * 1000; // 24 hours in milliseconds
          updateProgressBar(progressBar, diff, totalTime);
        }

        updateCountdown();
        return setInterval(updateCountdown, 1000);
      }

      function addToHistory(time1, time2, result) {
        const historyBody = document.getElementById("historyBody");
        const newRow = document.createElement("tr");
        newRow.innerHTML = `
                <td>${time1}</td>
                <td>${time2}</td>
                <td>${result}</td>
                <td class="action-cell">
                    <button class="delete-btn" onclick="deleteRow(this)">Supprimer</button>
                    <div class="progress-container">
                        <div class="progress-bar"></div>
                    </div>
                    <span class="countdown">00:00:00</span>
                </td>
            `;
        historyBody.appendChild(newRow);

        // Start countdown for this row
        startCountdown(newRow, result);
      }

      function calculate() {
        const time1 = document.getElementById("time1").value;
        const time2 = document.getElementById("time2").value;

        if (!validateTimeFormat(time1) || !validateTimeFormat(time2)) {
          showToast("Format d'heure invalide. Utilisez HH:MM:SS", "error");
          return;
        }

        const D4 = timeToMinutes(time2) - timeToMinutes(time1);
        const E4 = timeToMinutes(time2) + timeToMinutes(time1);
        const G2 = timeToMinutes(time1.split(":")[0] + ":00:00");
        const F4 = E4 - D4 * 2 - G2;

        const result = minutesToTime(F4);

        // Pre-remplir le premier champ avec la valeur du deuxième
        document.getElementById("time1").value = time2;
        document.getElementById("time2").value = "";

        showToast("Calcul effectué avec succès");
        addToHistory(time1, time2, result);
      }

      // Vérifier et nettoyer les résultats dépassés toutes les minutes
      setInterval(() => {
        const now = new Date();
        const rows = document
          .getElementById("historyBody")
          .getElementsByTagName("tr");

        for (let row of rows) {
          const resultTime = row.cells[2].textContent;
          const [hours, minutes, seconds] = resultTime.split(":").map(Number);
          const resultDate = new Date();
          resultDate.setHours(hours, minutes, seconds);

          if (resultDate < now) {
            row.classList.add("fade-out");
            setTimeout(() => row.remove(), 300);
          }
        }
      }, 60000);
    </script>
  </body>
</html>
